---
title: "Turnover"
format:
  html:
    fig-width: 10
    fig-height: 6
---


# Trend of Exits 

This is where we will provide a more detail view into the turnover both at Jackson as well as provide a larger view of how this organization is relative to the state wide view as well as the nationwide view.

```{r}
#| echo: false
#| warning: false
#| error: false
library(tidyverse)
theme_set(theme_bw())
jcolor <- c("#5a2158", "#EF0029", "#983560", "#cb575e", "#ee8757", "#febe57", "#f9f871")

source(here::here("src", "monthly_employee.R"))


emp_clean <- readRDS(file = here::here("data", "employee.RDS"))
emp_dates <- readRDS(file = here::here("data", "employee_dates.RDS"))

#---- exit by month

exit <-
  emp_dates |> 
  group_by(Term_Month) |> 
  summarise(exits = n()) |> 
  ungroup()

```

```{r}
#| echo: false
#| warning: false
#| error: false
#| out-width: "100%"
#| out-height: "40%"
#| fig-align: center
exit |> 
  filter(Term_Month < as.Date("2025-10-01")) |> 
    filter(Term_Month >= as.Date("2018-01-01")) |> 
    ggplot(aes(Term_Month, exits))+
    geom_point()+
    geom_line()+
  scale_x_date(date_breaks = "6 month", date_labels = "%m-%Y") + 
  scale_color_manual(values = jcolor) +
  labs(title = "Count of Employees Exits By Month",
    x = NULL, y= NULL) + 
  theme(
    panel.background = element_rect(fill = "#F8F5F5"),
    plot.background = element_rect(fill = "#F8F5F5")
  )

```

We see that there was a spike in early 2022, and then the count of exits hit a steady state for the year. Then again in 2023 there was a spike in exits with it hitting another steady state.

It looks like the exits have returned to roughly pre-pandemic levels in 2024 going forward.

## Overall Turnover Rate

```{r}
#| echo: false
#| warning: false
#| error: false
#| out-width: "100%"
#| out-height: "40%"
#| fig-align: center

turnover_month <- emp_dates |> 
  # head(10) |> 
  rename(start_date = Hire_Date,
        end_date = CleanEnd) |> 
  select(employee_id = ID, start_date, end_date) |> 
  create_monthly_activity() |> 
  left_join( , y= emp_clean |> select(ID, Time_Type), 
      by = join_by(employee_id == ID)) |> 
  group_by(month, Time_Type) |> 
  summarise(active_employee = n()) |> 
  ungroup() |> 
  filter(month >= as.Date("2018-01-01")) |> 
  left_join( , y= emp_dates |> 
                  left_join(., y=emp_clean |> select(ID, Time_Type), by = join_by(ID)) |> 
                  group_by(Term_Month, Time_Type) |> 
                  summarise(exits = n()) |> 
                  ungroup(), 
        by = join_by(month == Term_Month, Time_Type)) |> 
  mutate(exits = ifelse(is.na(exits), 0, exits)) |> 
  mutate(turnover = exits/active_employee) |> 
  ungroup()


turnover_month |> 
  filter(month < as.Date("2025-10-01")) |> 
    filter(month >= as.Date("2018-01-01")) |> 
    ggplot(aes(month, turnover, color = Time_Type))+
    geom_point()+
    geom_line()+
  scale_x_date(date_breaks = "6 month", date_labels = "%m-%Y") + 
  scale_color_manual(values = jcolor) +
  labs(title = "Count of Employees Exits By Month and Employeement Type",
    x = NULL, y= NULL) + 
  theme(
    panel.background = element_rect(fill = "#F8F5F5"),
    plot.background = element_rect(fill = "#F8F5F5"),
    legend.background = element_rect(fill = "#F8F5F5"),
    legend.key = element_rect(fill = "#F8F5F5", color = "darkgrey")
  )



```


# Analysis Overview

::: panel-tabset
## Exits:

What population is seeing the largest impact?

```{r}
exit
```

## Voluntary vs Involuntary

```{r}

```

## Turnover rate

-   Calculations

## Next Steps

-   Detailing the current tur
:::


# Notes

The initial exploratory data analysis (EDA) was performed within 'src/clean_employee.R' which can be found within the source code.